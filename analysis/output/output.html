<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>An applied example of information loss due to categorising uncertainty in epidemic modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>


<script src="output_files/libs/clipboard/clipboard.min.js"></script>
<script src="output_files/libs/quarto-html/quarto.js"></script>
<script src="output_files/libs/quarto-html/popper.min.js"></script>
<script src="output_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="output_files/libs/quarto-html/anchor.min.js"></script>
<link href="output_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="output_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="output_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="output_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="output_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">An applied example of information loss due to categorising uncertainty in epidemic modelling</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<div class="cell">

</div>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<div class="cell">

</div>
<p>A total of six modelling teams submitted projections to the European COVID-19 Scenario Hub in Round 2 (# to # 2022). Teams selected which targets to model from a large set of possible projection targets (32 countries, 2 outcomes), with only two teams submitting projections for nearly all targets. Teams were asked to model four scenarios for each target.</p>
<p>Here we only consider targets with results from three or more models for all four scenarios. This included weekly incident cases in Spain, the Netherlands, and Belgium; and weekly incident deaths in the Netherlands and Belgium. For each of these five targets, three teams contributed separate projections for each of the four scenarios. Two teams contributed 100 samples each, and one team contributed 96 samples. Therefore in total we consider 5920 samples (1480 samples for each of four scenarios), where each sample comprises a weekly time-series projection over up to one year.</p>
<section id="result-1" class="level4">
<h4 class="anchored" data-anchor-id="result-1">Result 1</h4>
<p>First we explore epidemic characteristics using sample trajectories. We summarised information about cumulative outbreak size over the projection period. For each target, we compared the cumulative number of projected outcomes to a threshold of the cumulative total over the one year before projections started (to July 2022). Across all 5,920 trajectories for all targets, 10% saw a cumulative total exceeding the relevant threshold. This varied widely, for example in Belgium where 25% and 2.5% of all trajectories would see a cumulative total exceeding the previous year’s total number of cases and deaths respectively.</p>
<p>Sample trajectories also allowed us to explore projected peaks in incidence. We looked at peaks both over the entire projection period, and over only the autumn-winter period (October through March). In summarising peak characteristics, we considered both the timing and maximum weekly incidence of each peak, and the total number of peaks, representing distinct epidemic waves and the timing of their turning points.</p>
<p>These epidemic characteristics could not be meaningfully estimated from the same results summarised into quantiles, as this sequence of summaries has no theoretical continuity through the time-series.</p>
</section>
<section id="result-2" class="level4">
<h4 class="anchored" data-anchor-id="result-2">Result 2</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="output_files/figure-html/create-ensembles-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Figure 1. Comparison of trajectories, an ensemble of trajectories, an ensemble of quantiles, and a weighted ensemble of trajectories weighted by performance against 28 weeks’ observed data</em></p>
<p>Next we took a set of 23 quantiles from the distribution of samples provided by each model for each target. We created an ensemble using a median average at each quantile interval. We compared this ensemble (figure 1B), to taking the same set of quantiles directly from the entire set of samples provided by all models (figure 1C).</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="output_files/figure-html/width-ensembles-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Figure 2. Mean central prediction intervals across time and scenarios. Mean lower and upper interval bounds: 52 week mean of quantiles in the sample and quantile ensembles</em></p>
<p>We created two ensemble projections derived from the same set of samples, with an identical set of quantile intervals representing a probabilistic projection at each time point. To compare between the two ensembles, we took the average of values at each quantile across all time points and scenarios (figure 2).</p>
<p>This showed both ensembles produced similar values around the centre of the distribution, with no noticeable difference between the median values of each projection. However, the two ensembles increasingly diverged in projecting the outer upper limit of the probabilistic distribution. At the upper 98% probability interval, ensemble projections for cases in Spain averaged nearly six times higher incidence when drawn from 100 samples compared to when drawn from quantiles (respectively averaging 1016 and 173 weekly new cases per 100,000 population). Across all five targets, the pattern held that an ensemble based on samples produced sharply increasing uncertainty between the 90% to 98% intervals. Meanwhile in an ensemble based on quantiles projected values were closer across upper bound probabilistic intervals.</p>
</section>
<section id="result-3" class="level4">
<h4 class="anchored" data-anchor-id="result-3">Result 3</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="output_files/figure-html/samples-weights-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Figure 3. Weight of individual samples in an ensemble across all available samples for each of five projection targets. Samples were weighted by the inverse of mean absolute error against 28 weeks’ observed data, meaning higher weight reflects better forecasting performance.</em></p>
<p>We then considered the forecasting performance of individual samples against 28 weeks’ observed data (figure 3). The performance of each sample varied substantially between both models and targets. When weighted by inverse MAE, no sample received more than 0.33% weight (among n=1184 samples for each target). Weighting was heavily skewed across samples for some targets, including cases in Spain and Belgium with outlying clusters of highly weighted predictive samples from one model. Weights were more uniform across samples’ forecast performance for deaths in the Netherlands and Belgium.</p>
<p>Creating an ensemble using the weighted performance of samples helped reduce the uncertainty of the future projection (figure 1D).</p>
<div class="cell">

</div>
<p>In the Netherlands in the final week of projections for deaths, the most extreme single trajectory projected an incident 2.8 per 100,000 in the final week of projections. However when we weighted all trajectories by performance and took quantiles from this distribution, the upper limit of 99% probability suggested an incidence over 8 times lower, at 0.33 per 100,000.</p>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<ul>
<li><p>Summary of results</p></li>
<li><p>Strengths of using samples:</p>
<ul>
<li>Samples show trajectory shapes, peaks, and cumulative burdens</li>
<li>Weighting only possible from samples - samples can continue to be used, quantiles are one-off results</li>
</ul></li>
<li><p>Limitations</p>
<ul>
<li>Simple ensemble still doesn’t solve the problem of combining multiple shapes in one epidemic curve</li>
</ul></li>
</ul>
<p>We collected three models for five targets in Spain, the Netherlands, and Belgium. Data reporting quality varied substantially between these targets. However, assuming all models had access to the same data sources, our conclusions with respect to the process of reducing samples to quantiles remain valid.</p>
<p>Scenarios offer a way to explore epistemic uncertainty by explicitly varying assumptions about system characteristics. However, the reduction of model outputs to quantile probabilities limits this possibility.</p>
<ul>
<li>Conclusions and recommendations
<ul>
<li>Depends what the focus + longevity of the project is:</li>
<li>Little difference (i.e.&nbsp;little information is lost) if the focus is one-off, or only on the central estimates</li>
<li>Samples better if focus is long-term use of one set of results, on peaks and cumulative sizes, or on outer bounds of uncertainty</li>
</ul></li>
<li>Further work
<ul>
<li>Number of samples to collect from each model</li>
<li>Ensemble by shape of epidemic curve</li>
</ul></li>
</ul>
<p>Weighting by performance meant we narrowed our set of trajectories to increasingly plausible projections of the future. Conditioning on observed data meant we excluded epidemic shapes based on autocorrelations to unrealised events</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>